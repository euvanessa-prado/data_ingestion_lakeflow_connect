<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Ingestion com Lakeflow Connect - Guia Completo</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #1a1a1a;
            color: #1a1a1a;
            line-height: 1.6;
        }
        .container { 
            max-width: 1400px; 
            margin: 0 auto; 
            padding: 20px;
            position: relative;
            z-index: 1;
        }
        header {
            background: linear-gradient(135deg, #FF3621 0%, #FF6B3D 50%, #FF8C5A 100%);
            padding: 50px 40px;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(255,54,33,0.4), 0 0 0 1px rgba(255,255,255,0.1);
            border: none;
            margin-bottom: 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: pulse 15s ease-in-out infinite;
        }
        @keyframes pulse {
            0%, 100% { transform: translate(0, 0) scale(1); }
            50% { transform: translate(-10%, -10%) scale(1.1); }
        }
        h1 { 
            color: white; 
            font-size: 2.5em; 
            margin-bottom: 10px;
            font-weight: 700;
            text-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        .tabs {
            display: flex;
            gap: 5px;
            background: linear-gradient(180deg, #2d2d2d 0%, #252525 100%);
            padding: 15px 20px 0;
            border-radius: 12px 12px 0 0;
            box-shadow: 0 4px 20px rgba(0,0,0,0.4);
            overflow-x: auto;
            border: 1px solid rgba(255,54,33,0.2);
            border-bottom: none;
        }
        .tab {
            padding: 12px 24px;
            background: transparent;
            border: none;
            border-radius: 8px 8px 0 0;
            cursor: pointer;
            font-size: 0.95em;
            font-weight: 500;
            transition: all 0.2s;
            white-space: nowrap;
            color: #999;
        }
        .tab:hover { 
            background: rgba(255,54,33,0.1);
            color: #FF3621;
        }
        .tab.active {
            background: white;
            color: #FF3621;
            font-weight: 600;
        }
        .tab-content {
            display: none;
            background: linear-gradient(180deg, #ffffff 0%, #fafafa 100%);
            padding: 40px;
            border-radius: 0 0 12px 12px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
            margin-bottom: 30px;
            border: 1px solid rgba(255,54,33,0.2);
            border-top: none;
            color: #1a1a1a;
        }
        .tab-content.active { display: block; }
        h2 { 
            color: #FF3621; 
            margin-bottom: 20px; 
            font-size: 1.8em;
            font-weight: 700;
        }
        h3 { 
            color: #FF3621; 
            margin: 25px 0 15px; 
            font-size: 1.3em;
            font-weight: 600;
        }
        .code-block {
            background: #f8f8f8;
            color: #1a1a1a;
            padding: 20px;
            border-radius: 6px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Monaco', 'Menlo', 'Courier New', monospace;
            font-size: 0.9em;
            position: relative;
            border: 1px solid #e0e0e0;
        }
        .code-block code { color: #0066cc; }
        .flow-image {
            max-width: 600px;
            width: 100%;
            height: auto;
            border-radius: 12px;
            box-shadow: 0 8px 24px rgba(255,54,33,0.2), 0 0 0 1px rgba(255,54,33,0.1);
            margin: 30px auto;
            display: block;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .flow-image:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 32px rgba(255,54,33,0.3), 0 0 0 1px rgba(255,54,33,0.2);
        }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #e0e0e0; }
        th { background: #f8f8f8; color: #1a1a1a; border: 1px solid #e0e0e0; font-weight: 600; }
        .tip-box {
            background: #fffbeb;
            border-left: 4px solid #f59e0b;
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
            border: 1px solid #fde68a;
        }
        .badge {
            display: inline-block;
            background: #FF3621;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            margin: 5px;
        }
        .explanation {
            background: #f0f7ff;
            padding: 15px;
            border-left: 4px solid #0066cc;
            margin: 15px 0;
            border-radius: 4px;
            border: 1px solid #d0e4ff;
        }
        ul { margin-left: 30px; margin-top: 10px; }
        li { margin: 8px 0; }
        footer {
            background: linear-gradient(135deg, #2d2d2d 0%, #1a1a1a 100%);
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(255,54,33,0.3), inset 0 1px 0 rgba(255,255,255,0.1);
            text-align: center;
            border: 2px solid #FF3621;
            position: relative;
            overflow: hidden;
        }
        footer::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,54,33,0.1), transparent);
            animation: shine 3s infinite;
        }
        @keyframes shine {
            0% { left: -100%; }
            100% { left: 200%; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìö Data Ingestion com Lakeflow Connect</h1>
            <p style="font-size: 1.2em; color: rgba(255,255,255,0.95); margin-top: 10px;">Guia Completo e Detalhado</p>
            <div style="margin-top: 20px;">
                <span class="badge">Databricks</span>
                <span class="badge">Unity Catalog</span>
                <span class="badge">Auto Loader</span>
                <span class="badge">Delta Lake</span>
                <span class="badge">Lakeflow</span>
            </div>
        </header>

        <div class="tabs">
            <button class="tab active" onclick="openTab(event, 'visao-geral')">üìä Vis√£o Geral</button>
            <button class="tab" onclick="openTab(event, 'notebook1')">1Ô∏è‚É£ Cat√°logos e Schemas</button>
            <button class="tab" onclick="openTab(event, 'notebook2')">2Ô∏è‚É£ Volumes</button>
            <button class="tab" onclick="openTab(event, 'notebook3')">3Ô∏è‚É£ Data Ingestion</button>
            <button class="tab" onclick="openTab(event, 'notebook4')">4Ô∏è‚É£ Auto Loader</button>
            <button class="tab" onclick="openTab(event, 'comparacao')">‚öñÔ∏è Compara√ß√£o</button>
            <button class="tab" onclick="openTab(event, 'comandos')">üîç Comandos √öteis</button>
        </div>

        <!-- TAB: Vis√£o Geral -->
        <div id="visao-geral" class="tab-content active">
            <h2>üéØ Vis√£o Geral do Projeto</h2>
            <p style="font-size: 1.1em; margin-bottom: 20px;">
                Este projeto demonstra <strong>4 t√©cnicas diferentes</strong> de ingest√£o de dados no Databricks,
                desde batch simples at√© streaming autom√°tico com Auto Loader.
            </p>

            <h3>üîÑ Fluxo Completo do Processo</h3>
            <img src="ChatGPT Image Nov 29, 2025, 11_16_14 AM.png" alt="Fluxo do Processo" class="flow-image">

            <h3>üèóÔ∏è Arquitetura Medallion</h3>
            <table>
                <tr>
                    <th>Camada</th>
                    <th>Descri√ß√£o</th>
                    <th>Qualidade dos Dados</th>
                </tr>
                <tr>
                    <td>ü•â <strong>Bronze (Landing)</strong></td>
                    <td>Dados brutos como chegaram</td>
                    <td>Sem transforma√ß√£o</td>
                </tr>
                <tr>
                    <td>ü•à <strong>Silver</strong></td>
                    <td>Dados limpos e validados</td>
                    <td>Qualidade intermedi√°ria</td>
                </tr>
                <tr>
                    <td>ü•á <strong>Gold</strong></td>
                    <td>Dados agregados para consumo</td>
                    <td>Pronto para an√°lise</td>
                </tr>
            </table>

            <div class="tip-box">
                <h3>üí° Por que usar esta arquitetura?</h3>
                <ul>
                    <li>‚úÖ <strong>Rastreabilidade:</strong> Sempre tem os dados originais</li>
                    <li>‚úÖ <strong>Reprocessamento:</strong> Pode refazer transforma√ß√µes</li>
                    <li>‚úÖ <strong>Qualidade:</strong> Dados ficam progressivamente melhores</li>
                    <li>‚úÖ <strong>Governan√ßa:</strong> Controle de acesso por camada</li>
                </ul>
            </div>
        </div>

        <!-- TAB: Notebook 1 -->
        <div id="notebook1" class="tab-content">
            <h2>1Ô∏è‚É£ Notebook 1: Cria√ß√£o de Cat√°logos e Schemas</h2>
            <p><strong>Objetivo:</strong> Criar a estrutura organizacional b√°sica no Unity Catalog</p>

            <h3>üìù Comando 1: Criar o Cat√°logo</h3>
            <div class="code-block">
<code>CREATE CATALOG IF NOT EXISTS smart_claims_dev
COMMENT 'Cat√°logo principal para o projeto Smart Claims - Ambiente de Desenvolvimento'</code>
            </div>
            <div class="explanation">
                <strong>Explica√ß√£o linha por linha:</strong>
                <ul>
                    <li><code>CREATE CATALOG</code> ‚Üí Cria um novo cat√°logo (n√≠vel mais alto de organiza√ß√£o)</li>
                    <li><code>IF NOT EXISTS</code> ‚Üí S√≥ cria se n√£o existir (evita erro)</li>
                    <li><code>smart_claims_dev</code> ‚Üí Nome do cat√°logo</li>
                    <li><code>COMMENT</code> ‚Üí Documenta√ß√£o do prop√≥sito</li>
                </ul>
            </div>

            <h3>üìù Comando 2: Verificar Cat√°logo Criado</h3>
            <div class="code-block">
<code>SHOW CATALOGS LIKE 'smart_claims_dev*'</code>
            </div>
            <div class="explanation">
                <strong>O que faz:</strong> Lista todos os cat√°logos que come√ßam com "smart_claims_dev"
            </div>

            <h3>üìù Comando 3: Criar Schema Landing (00_landing)</h3>
            <div class="code-block">
<code>CREATE SCHEMA IF NOT EXISTS smart_claims_dev.00_landing
COMMENT 'Zona de landing - recep√ß√£o de dados brutos de sistemas externos'</code>
            </div>
            <div class="explanation">
                <strong>Prop√≥sito:</strong> √Årea para receber dados brutos antes de qualquer processamento
            </div>

            <h3>üìù Comando 4: Criar Schema Bronze (01_bronze)</h3>
            <div class="code-block">
<code>CREATE SCHEMA IF NOT EXISTS smart_claims_dev.01_bronze
COMMENT 'Camada Bronze - dados brutos preservados de forma imut√°vel'</code>
            </div>
            <div class="explanation">
                <strong>Prop√≥sito:</strong> Armazena dados originais sem transforma√ß√£o (hist√≥rico completo)
            </div>

            <h3>üìù Comando 5: Criar Schema Silver (02_silver)</h3>
            <div class="code-block">
<code>CREATE SCHEMA IF NOT EXISTS smart_claims_dev.02_silver
COMMENT 'Camada Silver - dados limpos, validados e enriquecidos'</code>
            </div>
            <div class="explanation">
                <strong>Prop√≥sito:</strong> Dados limpos, com tipos corretos e valida√ß√µes aplicadas
            </div>

            <h3>üìù Comando 6: Criar Schema Gold (03_gold)</h3>
            <div class="code-block">
<code>CREATE SCHEMA IF NOT EXISTS smart_claims_dev.03_gold
COMMENT 'Camada Gold - dados agregados e modelados para consumo final'</code>
            </div>
            <div class="explanation">
                <strong>Prop√≥sito:</strong> Dados prontos para dashboards, relat√≥rios e an√°lises
            </div>

            <h3>üìù Comando 7: Listar Todos os Schemas</h3>
            <div class="code-block">
<code>SHOW SCHEMAS IN smart_claims_dev</code>
            </div>
            <div class="explanation">
                <strong>Resultado esperado:</strong>
                <ul>
                    <li>00_landing</li>
                    <li>01_bronze</li>
                    <li>02_silver</li>
                    <li>03_gold</li>
                </ul>
            </div>

            <h3>üìù Comando 8: Descrever o Cat√°logo</h3>
            <div class="code-block">
<code>DESCRIBE CATALOG smart_claims_dev</code>
            </div>
            <div class="explanation">
                <strong>O que mostra:</strong> Informa√ß√µes detalhadas do cat√°logo (owner, localiza√ß√£o, coment√°rios)
            </div>

            <h3>üìù Comando 9: Descrever um Schema</h3>
            <div class="code-block">
<code>DESCRIBE SCHEMA smart_claims_dev.00_landing</code>
            </div>
            <div class="explanation">
                <strong>O que mostra:</strong> Detalhes do schema (localiza√ß√£o, owner, propriedades)
            </div>
        </div>

        <!-- TAB: Notebook 2 -->
        <div id="notebook2" class="tab-content">
            <h2>2Ô∏è‚É£ Notebook 2: Cria√ß√£o de Volumes</h2>
            <p><strong>Objetivo:</strong> Criar volumes para armazenar arquivos CSV</p>

            <h3>üìù Comando 1: Usar o Cat√°logo</h3>
            <div class="code-block">
<code>USE CATALOG smart_claims_dev</code>
            </div>
            <div class="explanation">
                <strong>O que faz:</strong> Define o cat√°logo padr√£o para os pr√≥ximos comandos
            </div>

            <h3>üìù Comando 2: Verificar Schemas</h3>
            <div class="code-block">
<code>SHOW SCHEMAS IN smart_claims_dev LIKE '00_landing'</code>
            </div>
            <div class="explanation">
                <strong>O que faz:</strong> Confirma que o schema 00_landing existe
            </div>

            <h3>üìù Comando 3: Criar Volume para SQL Server</h3>
            <div class="code-block">
<code>CREATE VOLUME IF NOT EXISTS smart_claims_dev.00_landing.sql_server
COMMENT 'Volume para armazenar dados extra√≠dos do SQL Server (CSV: claims, customers, policies)'</code>
            </div>
            <div class="explanation">
                <strong>O que √© um Volume?</strong>
                <ul>
                    <li>üìÅ Espa√ßo para armazenar <strong>arquivos</strong> (n√£o tabelas)</li>
                    <li>üìÅ Suporta CSV, JSON, Parquet, imagens, etc</li>
                    <li>üìÅ Gerenciado pelo Unity Catalog</li>
                    <li>üìÅ Caminho: <code>/Volumes/smart_claims_dev/00_landing/sql_server/</code></li>
                </ul>
            </div>

            <h3>üìù Comando 4: Listar Arquivos no Volume</h3>
            <div class="code-block">
<code>LIST '/Volumes/smart_claims_dev/00_landing/sql_server'</code>
            </div>
            <div class="explanation">
                <strong>O que faz:</strong> Mostra todos os arquivos dentro do volume
            </div>
        </div>

        <!-- TAB: Notebook 3 -->
        <div id="notebook3" class="tab-content">
            <h2>3Ô∏è‚É£ Notebook 3: Data Ingestion (Batch)</h2>
            <p><strong>Objetivo:</strong> Demonstrar 3 t√©cnicas diferentes de ingest√£o batch</p>

            <h3>üîß Setup Inicial</h3>
            <div class="code-block">
<code>-- Verificar contexto atual
SELECT current_catalog(), current_schema();

-- Definir cat√°logo e schema
USE CATALOG smart_claims_dev;
USE SCHEMA `00_landing`;</code>
            </div>

            <h3>üìù Explorar os Dados (Antes de Criar Tabela)</h3>
            <div class="code-block">
<code>-- M√©todo 1: Ler diretamente do CSV
SELECT *
FROM csv.`/Volumes/smart_claims_dev/00_landing/sql_server/claims.csv`;

-- M√©todo 2: Usar read_files
SELECT *
FROM read_files(
  '/Volumes/smart_claims_dev/00_landing/sql_server/claims.csv',
  format => 'csv'
)
LIMIT 10;</code>
            </div>
            <div class="explanation">
                <strong>Por que explorar primeiro?</strong>
                <ul>
                    <li>‚úÖ Ver a estrutura dos dados</li>
                    <li>‚úÖ Identificar colunas</li>
                    <li>‚úÖ Detectar problemas antes de criar tabela</li>
                </ul>
            </div>

            <h3>üîπ T√©cnica 1: CREATE TABLE AS SELECT (CTAS)</h3>
            <div class="code-block">
<code>-- Dropar tabela se existir (para demonstra√ß√£o)
DROP TABLE IF EXISTS smart_claims_dev.01_bronze.claims;

-- Criar tabela a partir do CSV
CREATE TABLE IF NOT EXISTS smart_claims_dev.01_bronze.claims
AS SELECT *
FROM read_files(
  '/Volumes/smart_claims_dev/00_landing/sql_server/claims.csv',
  format => 'csv'
);

-- Verificar dados
SELECT * FROM smart_claims_dev.01_bronze.claims;</code>
            </div>
            <div class="explanation">
                <strong>Quando usar CTAS:</strong>
                <ul>
                    <li>‚úÖ Carga inicial (primeira vez)</li>
                    <li>‚úÖ Dados pequenos/m√©dios</li>
                    <li>‚úÖ N√£o precisa de schema espec√≠fico</li>
                    <li>‚ùå N√£o detecta novos arquivos</li>
                    <li>‚ùå Sempre reescreve tudo</li>
                </ul>
            </div>

            <h3>üîπ T√©cnica 2: Python com PySpark</h3>
            <div class="code-block">
<code># Dropar tabela
%sql
DROP TABLE IF EXISTS smart_claims_dev.01_bronze.claims;

# Ler CSV com PySpark
df = (
    spark.read
    .format("csv")
    .option("header", True)  # Primeira linha √© cabe√ßalho
    .load("/Volumes/smart_claims_dev/00_landing/sql_server/claims.csv")
)

# Salvar como tabela Delta
df.write.mode("overwrite").saveAsTable("smart_claims_dev.01_bronze.claims")

# Ler e exibir
claims_table = spark.table("smart_claims_dev.01_bronze.claims")
display(claims_table)</code>
            </div>
            <div class="explanation">
                <strong>Quando usar Python:</strong>
                <ul>
                    <li>‚úÖ Precisa de transforma√ß√µes complexas</li>
                    <li>‚úÖ Quer mais controle sobre o processo</li>
                    <li>‚úÖ Integra√ß√£o com outras bibliotecas Python</li>
                    <li>‚úÖ L√≥gica condicional complexa</li>
                </ul>
            </div>

            <h3>üîπ T√©cnica 3: COPY INTO (Incremental)</h3>
            <div class="code-block">
<code>-- Passo 1: Criar tabela com schema definido
DROP TABLE IF EXISTS smart_claims_dev.01_bronze.claims;

CREATE OR REPLACE TABLE smart_claims_dev.01_bronze.claims (
    claim_no STRING,
    policy_no STRING,
    claim_date STRING,
    months_as_customer STRING,
    injury STRING,
    property STRING,
    vehicle STRING,
    total STRING,
    collision_type STRING,
    number_of_vehicles_involved STRING,
    age STRING,
    insured_relationship STRING,
    license_issue_date STRING,
    date STRING,
    hour STRING,
    type STRING,
    severity STRING,
    number_of_witnesses STRING,
    suspicious_activity STRING
)
COMMENT 'Landing raw claims data (CSV ‚Üí Bronze, raw strings)';

-- Passo 2: Copiar dados do CSV
COPY INTO smart_claims_dev.01_bronze.claims
FROM '/Volumes/smart_claims_dev/00_landing/sql_server/claims.csv'
FILEFORMAT = CSV
FORMAT_OPTIONS ('header'='true')
COPY_OPTIONS ('mergeSchema'='false');

-- Verificar
SELECT * FROM smart_claims_dev.01_bronze.claims;</code>
            </div>
            <div class="explanation">
                <strong>Quando usar COPY INTO:</strong>
                <ul>
                    <li>‚úÖ Cargas incrementais (di√°rias/semanais)</li>
                    <li>‚úÖ N√£o duplica dados j√° processados</li>
                    <li>‚úÖ Controle de schema</li>
                    <li>‚úÖ Rastreamento de arquivos processados</li>
                    <li>‚ùå Precisa executar manualmente</li>
                </ul>
            </div>

            <h3>üìù Verificar Detalhes da Tabela</h3>
            <div class="code-block">
<code>-- Ver estrutura
DESCRIBE TABLE EXTENDED smart_claims_dev.01_bronze.claims;

-- Ver localiza√ß√£o f√≠sica
SHOW CREATE TABLE smart_claims_dev.01_bronze.claims;</code>
            </div>
        </div>

        <!-- TAB: Notebook 4 -->
        <div id="notebook4" class="tab-content">
            <h2>4Ô∏è‚É£ Notebook 4: Auto Loader + Lakeflow (Streaming)</h2>
            <p><strong>Objetivo:</strong> Implementar ingest√£o autom√°tica e cont√≠nua</p>

            <h3>üîß Setup</h3>
            <div class="code-block">
<code>-- Verificar contexto
SELECT current_catalog(), current_schema();

-- Definir contexto
USE CATALOG smart_claims_dev;
USE SCHEMA 01_bronze;

-- Verificar novamente
SELECT current_catalog(), current_schema();</code>
            </div>

            <h3>üìä Conceito: Batch vs Streaming</h3>
            <table>
                <tr>
                    <th>Aspecto</th>
                    <th>Batch (Notebooks 1-3)</th>
                    <th>Streaming (Auto Loader)</th>
                </tr>
                <tr>
                    <td><strong>Execu√ß√£o</strong></td>
                    <td>Manual (voc√™ executa)</td>
                    <td>Autom√°tica (sempre rodando)</td>
                </tr>
                <tr>
                    <td><strong>Processamento</strong></td>
                    <td>Tudo de uma vez</td>
                    <td>Incremental (s√≥ novos arquivos)</td>
                </tr>
                <tr>
                    <td><strong>Lat√™ncia</strong></td>
                    <td>Alta (espera pr√≥xima execu√ß√£o)</td>
                    <td>Baixa (quase tempo real)</td>
                </tr>
                <tr>
                    <td><strong>Analogia</strong></td>
                    <td>Baixar filme completo</td>
                    <td>Assistir Netflix (streaming)</td>
                </tr>
            </table>

            <h3>üìù Explorar Dados</h3>
            <div class="code-block">
<code>-- Ver arquivo CSV
SELECT *
FROM csv.`/Volumes/smart_claims_dev/00_landing/sql_server/claims.csv`;

-- Dropar tabela para recriar
DROP TABLE IF EXISTS smart_claims_dev.01_bronze.claims;</code>
            </div>

            <h3>üîπ M√©todo 1: Streaming Table Simples</h3>
            <div class="code-block">
<code>CREATE OR REFRESH STREAMING TABLE smart_claims_dev.01_bronze.claims
AS
SELECT *
FROM read_files(
  '/Volumes/smart_claims_dev/00_landing/sql_server/claims.csv',
  format => 'csv',
  header => true
);</code>
            </div>
            <div class="explanation">
                <strong>O que acontece:</strong>
                <ul>
                    <li>üîÑ Monitora a pasta continuamente</li>
                    <li>üîÑ Detecta novos arquivos automaticamente</li>
                    <li>üîÑ Processa apenas arquivos novos</li>
                    <li>üîÑ Mant√©m checkpoint (n√£o reprocessa)</li>
                </ul>
            </div>

            <h3>üîπ M√©todo 2: Streaming com Agendamento</h3>
            <div class="code-block">
<code>CREATE OR REFRESH STREAMING TABLE smart_claims_dev.01_bronze.claims
SCHEDULE EVERY 1 WEEK
AS
SELECT *
FROM read_files(
  '/Volumes/smart_claims_dev/00_landing/sql_server/claims.csv',
  format => 'csv',
  header => true
);</code>
            </div>
            <div class="explanation">
                <strong>SCHEDULE EVERY:</strong>
                <ul>
                    <li><code>1 HOUR</code> ‚Üí Executa a cada hora</li>
                    <li><code>1 DAY</code> ‚Üí Executa diariamente</li>
                    <li><code>1 WEEK</code> ‚Üí Executa semanalmente</li>
                </ul>
            </div>

            <h3>üîπ M√©todo 3: Auto Loader com cloud_files()</h3>
            <div class="code-block">
<code>CREATE OR REFRESH STREAMING TABLE smart_claims_dev.01_bronze.claims
AS
SELECT *
FROM STREAM cloud_files(
  '/Volumes/smart_claims_dev/00_landing/sql_server/claims.csv',
  format => 'csv',
  header => true
);</code>
            </div>

            <h3>üîπ M√©todo 4: Lakeflow com Metadados (RECOMENDADO)</h3>
            <div class="code-block">
<code>CREATE OR REFRESH STREAMING LIVE TABLE smart_claims_dev.01_bronze.claims
COMMENT "Bronze ‚Äî sinistros (claims) a partir de 00_landing/sql_server/claims.csv"
TBLPROPERTIES ("quality" = "bronze")
AS
SELECT
  *,
  _metadata.file_path               AS input_file,
  _metadata.file_modification_time  AS input_file_mtime,
  current_timestamp()               AS ingested_at
FROM cloud_files(
  "/Volumes/smart_claims_dev/00_landing/sql_server",
  "csv",
  map(
    "header", "true",
    "cloudFiles.inferColumnTypes", "true",
    "cloudFiles.schemaEvolutionMode", "addNewColumns",
    "pathGlobFilter", "claims.csv"
  )
);</code>
            </div>
            <div class="explanation">
                <strong>Explica√ß√£o detalhada:</strong>
                <ul>
                    <li><code>STREAMING LIVE TABLE</code> ‚Üí Tabela sempre atualizada</li>
                    <li><code>_metadata.file_path</code> ‚Üí Rastreia origem do dado</li>
                    <li><code>_metadata.file_modification_time</code> ‚Üí Quando arquivo foi modificado</li>
                    <li><code>current_timestamp()</code> ‚Üí Quando foi ingerido</li>
                    <li><code>inferColumnTypes</code> ‚Üí Detecta tipos automaticamente</li>
                    <li><code>schemaEvolutionMode</code> ‚Üí Adiciona colunas novas automaticamente</li>
                    <li><code>pathGlobFilter</code> ‚Üí Filtra apenas arquivos espec√≠ficos</li>
                </ul>
            </div>

            <h3>üìù Verificar Dados</h3>
            <div class="code-block">
<code>SELECT * FROM smart_claims_dev.01_bronze.claims LIMIT 10;</code>
            </div>
        </div>

        <!-- TAB: Compara√ß√£o -->
        <div id="comparacao" class="tab-content">
            <h2>‚öñÔ∏è Compara√ß√£o dos M√©todos</h2>
            
            <table>
                <tr>
                    <th>M√©todo</th>
                    <th>Complexidade</th>
                    <th>Quando Usar</th>
                    <th>Vantagens</th>
                    <th>Desvantagens</th>
                </tr>
                <tr>
                    <td><strong>CTAS</strong></td>
                    <td>‚≠ê F√°cil</td>
                    <td>Carga inicial √∫nica</td>
                    <td>‚Ä¢ Simples<br>‚Ä¢ R√°pido<br>‚Ä¢ Sem configura√ß√£o</td>
                    <td>‚Ä¢ N√£o detecta novos arquivos<br>‚Ä¢ Sempre reescreve tudo</td>
                </tr>
                <tr>
                    <td><strong>Python</strong></td>
                    <td>‚≠ê‚≠ê M√©dio</td>
                    <td>Transforma√ß√µes complexas</td>
                    <td>‚Ä¢ Muito flex√≠vel<br>‚Ä¢ Controle total<br>‚Ä¢ Integra√ß√£o Python</td>
                    <td>‚Ä¢ Mais c√≥digo<br>‚Ä¢ Requer conhecimento Python</td>
                </tr>
                <tr>
                    <td><strong>COPY INTO</strong></td>
                    <td>‚≠ê‚≠ê M√©dio</td>
                    <td>Cargas incrementais manuais</td>
                    <td>‚Ä¢ Evita duplicatas<br>‚Ä¢ Controle de schema<br>‚Ä¢ Rastreamento</td>
                    <td>‚Ä¢ Execu√ß√£o manual<br>‚Ä¢ Precisa definir schema</td>
                </tr>
                <tr>
                    <td><strong>Auto Loader</strong></td>
                    <td>‚≠ê‚≠ê‚≠ê Avan√ßado</td>
                    <td>Produ√ß√£o (autom√°tico)</td>
                    <td>‚Ä¢ Totalmente autom√°tico<br>‚Ä¢ Schema evolution<br>‚Ä¢ Checkpoint<br>‚Ä¢ Quase tempo real</td>
                    <td>‚Ä¢ Configura√ß√£o mais complexa<br>‚Ä¢ Requer pipeline</td>
                </tr>
            </table>

            <h3>üéØ Recomenda√ß√µes por Cen√°rio</h3>
            <div class="tip-box">
                <h4>üìä Desenvolvimento/Testes</h4>
                <p>Use <strong>CTAS</strong> ou <strong>Python</strong> - mais simples e r√°pido para experimentar</p>
            </div>

            <div class="tip-box">
                <h4>üè≠ Produ√ß√£o com Cargas Agendadas</h4>
                <p>Use <strong>COPY INTO</strong> - controle e rastreamento sem complexidade de streaming</p>
            </div>

            <div class="tip-box">
                <h4>üöÄ Produ√ß√£o com Dados Cont√≠nuos</h4>
                <p>Use <strong>Auto Loader</strong> - automa√ß√£o completa e baixa lat√™ncia</p>
            </div>
        </div>

        <!-- TAB: Comandos √öteis -->
        <div id="comandos" class="tab-content">
            <h2>üîç Comandos √öteis para Explora√ß√£o</h2>

            <h3>üìä Explora√ß√£o de Cat√°logos e Schemas</h3>
            <div class="code-block">
<code>-- Ver todos os cat√°logos
SHOW CATALOGS;

-- Ver schemas de um cat√°logo
SHOW SCHEMAS IN smart_claims_dev;

-- Ver tabelas de um schema
SHOW TABLES IN smart_claims_dev.01_bronze;

-- Ver volumes
SHOW VOLUMES IN smart_claims_dev.00_landing;</code>
            </div>

            <h3>üìÅ Explora√ß√£o de Volumes e Arquivos</h3>
            <div class="code-block">
<code>-- Listar arquivos em um volume
LIST '/Volumes/smart_claims_dev/00_landing/sql_server';

-- Ler arquivo CSV diretamente
SELECT * FROM csv.`/Volumes/smart_claims_dev/00_landing/sql_server/claims.csv`;

-- Contar linhas do arquivo
SELECT COUNT(*) FROM csv.`/Volumes/smart_claims_dev/00_landing/sql_server/claims.csv`;</code>
            </div>

            <h3>üîç Explora√ß√£o de Tabelas</h3>
            <div class="code-block">
<code>-- Ver estrutura da tabela
DESCRIBE TABLE smart_claims_dev.01_bronze.claims;

-- Ver detalhes completos
DESCRIBE TABLE EXTENDED smart_claims_dev.01_bronze.claims;

-- Ver DDL da tabela
SHOW CREATE TABLE smart_claims_dev.01_bronze.claims;

-- Ver primeiras linhas
SELECT * FROM smart_claims_dev.01_bronze.claims LIMIT 10;

-- Contar registros
SELECT COUNT(*) FROM smart_claims_dev.01_bronze.claims;</code>
            </div>

            <h3>üìà An√°lise de Dados</h3>
            <div class="code-block">
<code>-- Ver colunas e tipos
SELECT column_name, data_type 
FROM information_schema.columns 
WHERE table_name = 'claims';

-- Estat√≠sticas b√°sicas
SELECT 
  COUNT(*) as total_records,
  COUNT(DISTINCT claim_no) as unique_claims,
  MIN(claim_date) as first_claim,
  MAX(claim_date) as last_claim
FROM smart_claims_dev.01_bronze.claims;

-- Ver valores nulos
SELECT 
  COUNT(*) - COUNT(claim_no) as null_claim_no,
  COUNT(*) - COUNT(policy_no) as null_policy_no
FROM smart_claims_dev.01_bronze.claims;</code>
            </div>

            <h3>üóëÔ∏è Limpeza e Manuten√ß√£o</h3>
            <div class="code-block">
<code>-- Dropar tabela
DROP TABLE IF EXISTS smart_claims_dev.01_bronze.claims;

-- Dropar schema (precisa estar vazio)
DROP SCHEMA IF EXISTS smart_claims_dev.00_landing;

-- Dropar cat√°logo (precisa estar vazio)
DROP CATALOG IF EXISTS smart_claims_dev;

-- Vacuum (limpar arquivos antigos)
VACUUM smart_claims_dev.01_bronze.claims RETAIN 168 HOURS;</code>
            </div>
        </div>

        <footer>
            <h2 style="color: white; margin-bottom: 15px; text-shadow: 0 2px 10px rgba(0,0,0,0.2);">üë©üèΩ‚Äçüíª Vanessa Prado</h2>
            <p style="font-size: 1.1em; margin-bottom: 10px;">
                <a href="https://github.com/euvanessa-prado" target="_blank" style="color: white; text-decoration: none; font-weight: bold; text-shadow: 0 1px 5px rgba(0,0,0,0.2);">
                    GitHub: @euvanessa-prado
                </a>
            </p>
            <p style="color: rgba(255,255,255,0.9); margin-top: 20px;"></p>
                ‚≠ê Projeto educacional - livre para uso e aprendizado!
            </p>
        </footer>
    </div>

    <script>
        function openTab(evt, tabName) {
            var i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tab-content");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
                tabcontent[i].classList.remove("active");
            }
            tablinks = document.getElementsByClassName("tab");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].classList.remove("active");
            }
            document.getElementById(tabName).style.display = "block";
            document.getElementById(tabName).classList.add("active");
            evt.currentTarget.classList.add("active");
        }
    </script>
</body>
</html>